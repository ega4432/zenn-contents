---
title: "React ã‚¢ãƒ—ãƒªã‚’ Kubernetes ã§å‹•ã‹ã—ã¦ã¿ãŸ"
emoji: "ğŸ™Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["kubernetes", "minikube", "docker", "react", "typescript"]
published: true
---
# ã¯ã˜ã‚ã«

å‹‰å¼·ãŒã¦ã‚‰ React ã‚¢ãƒ—ãƒªã‚’ Kubernetes ä¸Šã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã¿ãŸã®ã§å‚™å¿˜éŒ²ã¨ã—ã¦ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚

## ã“ã®è¨˜äº‹ã®ã‚´ãƒ¼ãƒ«

ãƒ­ãƒ¼ã‚«ãƒ«ã® Kubernetes ä¸Šã« React ã‚¢ãƒ—ãƒªã‚’å®Ÿè¡Œã—ã¦å‹•ä½œã‚’ç¢ºèªã§ãã‚‹ã¨ã“ã‚ã¾ã§ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚

## å‰æ

:::message alert
Docker ã‚„ Kubernetes, React ã®è©³ç´°ãªè§£èª¬ã«ã¤ã„ã¦ã¯æœ¬è¨˜äº‹ã§ã¯å‰²æ„›ã—ã¦ã„ã¾ã™ã€‚ã‚ãã¾ã§ã‚‚ Kubernetes ã‚’è§¦ã£ã¦ã¿ã¦é›°å›²æ°—ã‚’æ´ã¿ãŸã„æ–¹å‘ã‘ã§ã™ã€‚
:::

ç’°å¢ƒã«ã¤ã„ã¦ã¯ macOS ã‚’ä½¿ç”¨ã—ã¦ã„ã¦ã€Home Brew ã‚’å°å…¥æ¸ˆã¿ã¨ã„ã†å‰æã§é€²ã‚ã¾ã™ã€‚ä½¿ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¯å¾Œè¿°ã—ã¾ã™ã€‚

```sh
% sw_vers
ProductName:    macOS
ProductVersion: 12.0.1
BuildVersion:   21A559
```

# ä½¿ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã¨ãã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- Docker
- Minikube
  - ãƒ­ãƒ¼ã‚«ãƒ«ã§ç°¡å˜ã« Kubernetes ã‚’å®Ÿè¡Œã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚è©¦ã—ã«å‹•ã‹ã—ã¦ã¿ãŸã„å ´åˆã«ä½¿ãˆã‚‹ã®ã§é‡å®ã—ã¦ã„ã¾ã™ã€‚è©³ã—ãã¯[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://kubernetes.io/ja/docs/setup/learning-environment/minikube/)ã‚’ã”è¦§ãã ã•ã„ã€‚
- kubectl
  - Kubernetes ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æœ¬è¨˜äº‹ã¯ macOS ãƒ¦ãƒ¼ã‚¶å‘ã‘ãªã®ã§ã€ãã†ã§ã¯ãªã„æ–¹ã¯ã“ã¡ã‚‰ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® [kubectlã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŠã‚ˆã³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](https://kubernetes.io/ja/docs/tasks/tools/install-kubectl/) ã‚’ã”è¦§ãã ã•ã„ã€‚

ãã‚Œãã‚Œ Home Brew çµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚

```sh
# Minikube
% brew install minikube

% minikube version
minikube version: v1.23.0
commit: 5931455374810b1bbeb222a9713ae2c756daee10

# kubectl
% brew install kubectl

% kubectl version
Client Version: version.Info{Major:"1", Minor:"22", GitVersion:"v1.22.1", GitCommit:"632ed300f2c34f6d6d15ca4cef3d3c7073412212", GitTreeState:"clean", BuildDate:"2021-08-19T15:38:26Z", GoVersion:"go1.16.6", Compiler:"gc", Platform:"darwin/amd64"}
Server Version: version.Info{Major:"1", Minor:"22", GitVersion:"v1.22.1", GitCommit:"632ed300f2c34f6d6d15ca4cef3d3c7073412212", GitTreeState:"clean", BuildDate:"2021-08-19T15:39:34Z", GoVersion:"go1.16.7", Compiler:"gc", Platform:"linux/amd64"}
```

## ã‚µã‚¯ãƒƒã¨è©¦ã—ã¦ã¿ãŸã„æ–¹

ã“ã‚Œã‹ã‚‰æ‰‹é †ã«æ²¿ã£ã¦è§£èª¬ã—ã¦ã„ãã®ã§ã™ãŒã€ãã‚“ãªã‚‚ã®ã¯ã„ã‚‰ãªã„ã‹ã‚‰ã¨ã‚Šã‚ãˆãšå‹•ã‹ã—ã¦ã¿ãŸã„ã¨ã„ã†æ–¹ã¯ä¸‹è¨˜ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¬é–‹ã—ã¦ã„ã‚‹ã®ã§ãã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ã€‚

https://github.com/ega4432/react-k8s-sample

# React ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

ã¾ãšã¯ã€ã‚·ãƒ³ãƒ—ãƒ«ãª React ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚

```sh
# é©å½“ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
% cd path/you/like

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦ TSã€€ã‚’æŒ‡å®šï¼‰
% npx create-react-app --template tyepscript react-k8s-sample
```

ã“ã‚Œã§ React ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é››å½¢ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚è©¦ã—ã«ç«‹ã¡ä¸Šã’ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```sh
% cd react-k8s-sample

# ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
% yarn

% yarn start
```

start ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ–ãƒ©ã‚¦ã‚¶ãŒç«‹ã¡ä¸ŠãŒã‚Š [localhost:3000](http://localhost:3000) ã‚’é–‹ãä¸‹è¨˜ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚ŒãŸã‚‰ OK ã§ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/cf6d3413dbd6-20211122.png)

ç¢ºèªã§ããŸã‚‰ ^C ã§ä¸€æ—¦åœæ­¢ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

# ã‚³ãƒ³ãƒ†ãƒŠåŒ–

ç¶šã„ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã—ã¦ã„ãã¾ã™ã€‚

## Dockerfile ã®ä½œæˆ

ã¾ãšã¯ã€ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã—ã¦ã„ãã«ã‚ãŸã‚Šã‚³ãƒ³ãƒ†ãƒŠã®ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã« Dockerfile ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä¸‹è¨˜ã®ã‚ˆã†ã«è¨˜è¿°ã—ã¾ã™ã€‚

```Dockerfile:Dockerfile
FROM node:16.13.0-alpine AS builder

WORKDIR /usr/local/app

COPY . .

RUN yarn --frozen-lockfile && \
    yarn build

FROM nginx:1.20-alpine

COPY --from=builder /usr/local/app/build /usr/share/nginx/html

CMD [ "nginx", "-g", "daemon off;" ]
```

ãã“ã¾ã§å‡ã£ãŸã“ã¨ã¯ã—ã¦ã„ã¾ã›ã‚“ãŒã€ç°¡å˜ã«è§£èª¬ã—ã¾ã™ã€‚

1 ã¤ç›®ã® FROM å‘½ä»¤ã§ãƒ“ãƒ«ãƒ‰ç”¨ã® node ã‚’ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚ãã—ã¦ React ã‚’ãƒ“ãƒ«ãƒ‰ã—ã€2 ã¤ç›®ã® FROM å‘½ä»¤ä»¥ä¸‹ã§ãƒ“ãƒ«ãƒ‰ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ« `./build` ä»¥ä¸‹ã‚’ nginx ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã‚³ãƒ”ãƒ¼ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«**ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰**ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Dockerfile ã®ä¿å®ˆæ€§ã‚’å‘ä¸Šã•ã›ã€æœ€çµ‚çš„ãªæˆæœç‰©ã¨ã—ã¦ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã‚’æŠ‘ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚å¯æ¬æ€§ãŒé«˜ã„ã¨ã„ã†ã‚³ãƒ³ãƒ†ãƒŠã®æ€§è³ªã‚’æ´»ã‹ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é€Ÿãã™ã‚‹ãŸã‚ã«ã‚‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã«ã¯å¸¸ã«æ°—ã«ã™ã‚‹ã“ã¨ã§ã™ã‚ˆã­ã€‚

## ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã€ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•

è¨˜è¿°ã—ãŸ Dockerfile ã‚’å…ƒã«ã‚³ãƒ³ãƒ†ãƒŠã§æ­£å¸¸ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒèµ·å‹•ã§ãã‚‹ã‹ç°¡å˜ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

```sh
# ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
% docker build --tag <YOUR_NAME>/react-k8s-sample:latest \
  --no-cache .

# ç”Ÿæˆã•ã‚ŒãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¢ºèª
% docker images --filter "dangling=false" \
    --format "table {{ .Repository }}:{{ .Tag }} {{ .Size }}" | \
    head -n 2
REPOSITORY:TAG                             SIZE
<YOUR_NAME>/react-k8s-sample:latest        23.7MB

# ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•
% docker run --name tmp-react-k8s-sample \
  --rm --publish 3000:80 \
  <YOUR_NAME>/react-k8s-sample:latest
```

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¦ã€ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã§ããŸã‚‰å†åº¦ [localhost:3000](http://localhost:3000) ã‚’é–‹ã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚å…ˆã»ã©ã¨åŒæ§˜ã« React ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã§ããŸã‚‰ OK ã§ã™ã€‚ã¾ãŸ ^C ã§ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã•ã›ã¦ãŠãã¾ã™ã€‚

## ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ—ãƒƒã‚·ãƒ¥

ä½œæˆã—ãŸ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚ä»Šå›ã¯ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã«ã¯ Docker Hub ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```sh
% docker push <YOUR_NAME>/react-k8s-sample:latest
```

# ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

ã“ã‚Œã‹ã‚‰ã‚ˆã†ã‚„ã Kubernetes ã§ã™ã€‚
Kubernetes ã§ã¯ãƒªã‚½ãƒ¼ã‚¹ã‚„ãã‚Œã‚‰ã®è¨­å®šã‚’ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨å‘¼ã°ã‚Œã‚‹ YAML ã«å®šç¾©ã—ã¾ã™ã€‚

ä»Šå›ã¯ Deployment ã¨ Service ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

```yaml:deployment-service.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: react-k8s-sample
spec:
  replicas: 1
  selector:
    matchLabels:
      app: react-k8s-sample
  template:
    metadata:
      labels:
        app: react-k8s-sample
    spec:
      containers:
      - name: react
        image: <YOUR_NAME>/react-k8s-sample   # Edit
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: react-k8s-sample
spec:
  type: NodePort
  selector:
    app: react-k8s-sample
  ports:
    - port: 3000
      targetPort: 80
      protocol: TCP
      name: react-k8s-sample
```

Deployment ã§ã¯ã€å…ˆã»ã©ä½œã£ãŸã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹ Pod ã¨ã€ãƒ¬ãƒ—ãƒªã‚«ã‚»ãƒƒãƒˆã‚’ï¼ˆã“ã“ã§ã¯å˜ã« 1 ã¤ï¼‰å®šç¾©ã—ã¦ã„ã¾ã™ã€‚`spec.template.spec.containers[0].image` ã®éƒ¨åˆ†ã ã‘ã”è‡ªèº«ã® Docker Hub ã®ãƒ¦ãƒ¼ã‚¶åã«æ›¸ãæ›ãˆã¦ãã ã•ã„ã€‚

Service ã§ã¯ã€Deployment ã§ä½œæˆã—ãŸ Pod ã«å¯¾ã—ã¦ã‚¯ãƒ©ã‚¹ã‚¿å¤–éƒ¨ã‹ã‚‰é€šä¿¡ã™ã‚‹ãŸã‚ã®è¨­å®šã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚Service ã®ç¨®é¡ã®ä¸­ã§ã‚‚é™çš„ãªãƒãƒ¼ãƒˆã§å…¬é–‹ã™ã‚‹ **NodePort** ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ã¾ãŸã€ä½™è«‡ã«ã¯ãªã‚Šã¾ã™ãŒã€ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ `---` ã§åˆ†ã‘ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¤‡æ•°ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å®šç¾©ã§ãã¾ã™ã€‚åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã®ç®¡ç†ã‚‚å¯èƒ½ã§ã™ãŒã€ä»Šå›ã¯ã“ã®é‡ãªã®ã§ 1 ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚

# Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ä¸Šã§å‹•ã‹ã™

## Minikube ã‚’èµ·å‹•

```sh
# Minikube ã‚’èµ·å‹•
% minikube start

..

ğŸ„  å®Œäº†ã—ã¾ã—ãŸï¼ kubectl ãŒã€Œ"minikube"ã€ã‚¯ãƒ©ã‚¹ã‚¿ã¨ã€Œ"default"ã€ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†æ§‹æˆã•ã‚Œã¾ã—ãŸ

# ç¢ºèª
% minikube status
minikube
type: Control Plane
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured
```

ä¸Šè¨˜ã®ã‚ˆã†ã« Running ã«ãªã£ã¦ã„ãŸã‚‰ OK ã§ã™ã€‚

## ãƒ‡ãƒ—ãƒ­ã‚¤

æ¬¡ã«ã€Minikube ä¸Šã® Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã«ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ã„ãŸãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ãã¾ã™ã€‚

:::message
ä¸€æ—¦ç¢ºèªã—ãŸã„å ´åˆã¯ `--dry-run=client` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦ kubectl ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
:::

```sh
# ãƒ‡ãƒ—ãƒ­ã‚¤
% kubectl apply --filename ./deployment-service.yaml
deployment.apps/react-k8s-sample created
service/react-k8s-sample created

# å®Ÿè¡Œçµæœã‚’ç¢ºèª
% kubectl get all | grep -v kubernetes
NAME                                    READY   STATUS    RESTARTS   AGE
pod/react-k8s-sample-6c5dc7dd67-wjvcj   1/1     Running   0          10m

NAME                       TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
service/react-k8s-sample   NodePort    10.111.180.101   <none>        3000:30669/TCP   40m

NAME                               READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/react-k8s-sample   1/1     1            1           40m

NAME                                          DESIRED   CURRENT   READY   AGE
replicaset.apps/react-k8s-sample-6544bfd9d6   1         1         1       4m19s
```

Pod ã‚„ Deployment ãªã©ã® READY ãŒ 0/1 ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€æ•°ç§’å¾…ã£ã¦å†åº¦å®Ÿè¡Œã™ã‚‹ã¨ä¸Šè¨˜ã®ã‚ˆã†ã« 1/1 ã¨ãªã‚Šã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚‚ Running ã¨ãªã‚Šã¾ã™ã€‚

## Service ã®å…¬é–‹

```sh
% kubectl get service | grep -v kubernetes
NAME               TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
react-k8s-sample   NodePort    10.111.180.101   <none>        3000:30669/TCP    4m
```

Service ã®æƒ…å ±ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€EXTERNAL-IP ãŒ none ã«ãªã£ã¦ã„ã¾ã™ã€‚ã“ã®ã¾ã¾ã ã¨ã‚¯ãƒ©ã‚¹ã‚¿å¤–ã‹ã‚‰ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã®ã§ã€NodePort çµŒç”±ã§ Service ã‚’å…¬é–‹ã—ã¾ã™ã€‚

```sh
% minikube service react-k8s-sample
```

ä¸Šè¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã‹ã‚Œã¦ä¸‹è¨˜ã®ã‚ˆã†ã«è¡¨ç¤ºãŒç¢ºèªã§ãã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/ee69f0f818ff-20211126.png)

ã“ã‚Œã§ Minikube ã‚’ä½¿ã£ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã® Kubernetes ä¸Šã« React ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¾ã—ãŸã€‚

## ã‚¯ãƒªãƒ¼ãƒ³ãƒŠãƒƒãƒ—

ä½œæ¥­ãŒçµ‚ã‚ã£ãŸã‚‰ãƒªã‚½ãƒ¼ã‚¹ã‚’åœæ­¢ã€å‰Šé™¤ã—ã¾ã™ã€‚

```sh
# Deployment, Service ã‚’å‰Šé™¤
% kubectl delete --filename ./deployment-service.yaml
deployment.apps "react-k8s-sample" deleted
service "react-k8s-sample" deleted

# ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®åœæ­¢
% minikube stop  
âœ‹  ãƒãƒ¼ãƒ‰ "minikube" ã‚’åœæ­¢ã—ã¦ã„ã¾ã™...
ğŸ›‘  SSH çµŒç”±ã§ã€Œminikubeã€ã®é›»æºã‚’ã‚ªãƒ•ã«ã—ã¦ã„ã¾ã™...
ğŸ›‘  1å°ã®ãƒãƒ¼ãƒ‰ãŒåœæ­¢ã—ã¾ã—ãŸ

# ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã®å‰Šé™¤
% minikube delete
ğŸ”¥  docker ã®ã€Œminikubeã€ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ”¥  ã‚³ãƒ³ãƒ†ãƒŠ "minikube" ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ”¥  /Users/<YOUR_NAME>/.minikube/machines/minikube ã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...
ğŸ’€  ã‚¯ãƒ©ã‚¹ã‚¿ "minikube" ã®å…¨ã¦ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚
```

# ã¾ã¨ã‚

ä»Šå›ã¯ Minikube ã‚’ä½¿ã£ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã® Kubernetes ä¸Šã« React ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã—ã¦ã¿ã¾ã—ãŸã€‚ã‹ãªã‚Šé•·ã€…ã¨ãªã£ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€kubectl ã‚³ãƒãƒ³ãƒ‰ã®ä½¿ã„æ–¹ã‚„ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã® YAML ã®æ›¸ãæ–¹ãªã©éå¸¸ã«å‹‰å¼·ã«ãªã‚‹ã“ã¨ãŒå¤šã£ãŸã§ã™ã€‚

Kubernetes ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å­¦ç¿’ãŒå¤§å¤‰ã§ã™ãŒã€ã“ã®ã‚ˆã†ã«å°‘ã—ãšã¤ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã§è§¦ã£ã¦è©¦ã™ã®ãŒãªã‚“ã ã‹ã‚“ã ã§è¿‘é“ãªæ°—ãŒã—ã¦ã„ã¾ã™ã€‚

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚å…¬é–‹ã—ã¦ã„ã‚‹ã®ã§ã€èª­ã‚“ã§ãã ã•ã£ã¦ã„ã‚‹æ–¹ã®å‚è€ƒã«ãªã‚ŒãŸã‚‰å¹¸ã„ã§ã™ã€‚

https://github.com/ega4432/react-k8s-sample

# å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸã‚µã‚¤ãƒˆ

https://kubernetes.io/ja/docs/concepts/workloads/controllers/deployment/
https://matsuand.github.io/docs.docker.jp.onthefly/develop/develop-images/multistage-build/
https://kubernetes.io/ja/docs/setup/learning-environment/minikube/
