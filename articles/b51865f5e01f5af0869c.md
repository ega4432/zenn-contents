---
title: "Red Hat CodeReady Containers ã§ OpenShift ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½¿ç”¨ã™ã‚‹"
emoji: "ğŸ‘»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["redhat", "kubernetes", "openshift", "container", "mac"]
published: true
---
# ã¯ã˜ã‚ã«

ã¾ãšã€Red Hat CodeReady Containers ã®è©±ã‚’ã™ã‚‹å‰ã«ãã‚‚ãã‚‚ OpenShift ã¨ã¯ã€ä¸€è¨€ã§ã„ã†ã¨ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º Kubernetes ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚Kubernetes ã¨æ¯”è¼ƒã—ã¦ CI/CD ãªã©é‹ç”¨é¢ã§ã®ä¾¿åˆ©ãªæ©Ÿèƒ½ãŒä»˜ã„ã¦ã„ã‚‹ã®ãŒç‰¹å¾´ã§ã™ã€‚è©³ã—ã„ç‰¹å¾´ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã® URL ã‚’ã”è¦§ãã ã•ã„ã€‚

https://www.redhat.com/ja/technologies/cloud-computing/openshift

ãã® OpenShift ã§ã™ãŒã€ã¨ã‚Šã‚ãˆãšãƒ­ãƒ¼ã‚«ãƒ«ã§è§¦ã£ã¦ã¿ãŸã„ã¨è€ƒãˆè¦‹ã¤ã‘ãŸã®ãŒã€ä»Šå›ç´¹ä»‹ã™ã‚‹ Red Hat CodeReady Containersï¼ˆä»¥ä¸‹ CRCï¼‰ã§ã™ã€‚

# ç’°å¢ƒ

ä»Šå›å°å…¥ã—ãŸç’°å¢ƒã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

 key | value
 :---: | :---:
OS | macOS Moneterey 12.2.1
Shell | zsh

ã¾ãŸ [ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://crc.dev/crc/) ã«ã¯ã€å‹•ä½œç’°å¢ƒã® Minimum system requirements ã¨ã—ã¦ä¸‹è¨˜ã‚’å‚™ãˆã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã¨è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

- 4 vCPU
- 9 GB ãƒ¡ãƒ¢ãƒª
- 35 GB ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡

# ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

äº‹å‰ã« Red Hat ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ãŸä¸Šã§ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ãã¾ã™ã€‚[ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚µã‚¤ãƒˆ](https://console.redhat.com/openshift/create/local) ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãƒ­ã‚°ã‚¤ãƒ³ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã®ã§ Red Hat ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã£ã¦ã„ãªã„å ´åˆã¯ä½œæˆã—ã¦ã€ä»Šå›ã¯ macOS ç”¨ï¼ˆãŠä½¿ã„ã®ãƒã‚·ãƒ³ã«ã‚ã£ãŸã‚‚ã®ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/4f0b302801eb-20220303.png)

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«ã¯ã—ã°ã‚‰ãæ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚
å¾…ã£ã¦ã„ã‚‹é–“ã« Secret æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ or ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¦ãŠãã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/2230d598713b-20220303.png)

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒçµ‚äº†ã—ãŸã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’é–‹ãã®ã§ã€æŒ‡ç¤ºã«å¾“ã£ã¦é€²ã‚ã¦ã„ãã¾ã™ã€‚ãã‚ŒãŒçµ‚ã‚ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€ç¶šãã¯ CUI ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ã„ãã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/2153f2c48ffa-20220303.png)

# åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ã¾ãš CRC ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ãˆã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚

```sh
$ crc version
CodeReady Containers version: 1.40.0+5966df09
OpenShift version: 4.9.18 (bundle installed at /Applications/CodeReady Containers.app/Contents/Resources/crc_hyperkit_4.9.18.crcbundle)
```

OpenShift 4.9.18 ã«å¯¾å¿œã—ãŸ CRC ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã®ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

ä½™è«‡ã§ã™ãŒã€ã„ã¤ã®é–“ã«ã‹ mac ã®ç”»é¢ãƒˆãƒƒãƒ—ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã«ã‚‚ OpenShift ã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```sh
$ crc setup
INFO Checking if running as non-root
..

ï¼ˆçœç•¥ï¼‰

..
Your system is correctly setup for using CodeReady Containers, you can now run 'crc start' to start the OpenShift cluster
```

### OpenShift ã‚¯ãƒ©ã‚¹ã‚¿ã‚’èµ·å‹•

`PATH` ã«ã¯ã€Secret æƒ…å ±ã‚’ä¿å­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```sh
# CRC ã‚’èµ·å‹•
$ crc start --pull-secret-file=<PATH>
INFO Checking if running as non-root
..

ï¼ˆçœç•¥ï¼‰

..
Started the OpenShift cluster.

The server is accessible via web console at:
  https://console-openshift-console.apps-crc.testing

Log in as administrator:
  Username: kubeadmin
  Password: r23rB-ZT5TB-SHKDF-rnhJd

Log in as user:
  Username: developer
  Password: developer

Use the 'oc' command line interface:
  $ eval $(crc oc-env)
  $ oc login -u developer https://api.crc.testing:6443
```

CRC ã®èµ·å‹•ãŒæˆåŠŸã™ã‚‹ã¨ä¸Šè¨˜ã®ã‚ˆã†ã« Web ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã® URL ã‚„èªè¨¼æƒ…å ±ã€OC ã‚³ãƒãƒ³ãƒ‰ã®ä½¿ã„æ–¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ä»¥ä¸Šã§ macOS ä¸Šã« CRC ã®å°å…¥æ–¹æ³•ã®èª¬æ˜ã¯çµ‚äº†ã§ã™ã€‚ã“ã‚Œã§ãƒ­ãƒ¼ã‚«ãƒ«ã«æ°—è»½ã« OpenShift ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

# ã‚ˆãä½¿ã† CRC ã‚³ãƒãƒ³ãƒ‰ã€Tips

ä¸€é€šã‚Š CRC ã‚’è§¦ã£ã¦ã¿ãŸã®ã§ã€ä½•å›ã‚‚ä½¿ã£ãŸã‚³ãƒãƒ³ãƒ‰ã‚„çŸ¥ã£ã¦ãŠãã¨ä¾¿åˆ©ãªã“ã¨ãªã©ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚

## ã‚¯ãƒ©ã‚¹ã‚¿ã®èµ·å‹•ã‚’ç¢ºèª

```sh
$ crc status
CRC VM:          Running
OpenShift:       Running (v4.9.18)
Disk Usage:      13.6GB of 32.74GB (Inside the CRC VM)
Cache Usage:     25.77GB
Cache Directory: /Users/<USER_NAME>/.crc/cache
```

## OpenShift Web ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‘¨ã‚Š

```sh
# Web ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã
$ crc console
# OR
$ crc dashboard

# Web ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ã€€URL ã®ã¿ã‚’è¡¨ç¤º
$ crc console --url
https://console-openshift-console.apps-crc.testing
```

## ãƒ­ã‚°ã‚¤ãƒ³

`oc login` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ CRC ã§ç«‹ã¡ä¸Šã’ãŸã‚¯ãƒ©ã‚¹ã‚¿ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¾ã™ã€‚

```sh
# Developer ãƒ¦ãƒ¼ã‚¶ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³
$ oc login -u developer -p developer https://api.crc.testing:6443

# Admin ãƒ¦ãƒ¼ã‚¶ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³
$ oc login -u kubeadmin -p <PASSWORD> https://api.crc.testing:6443
```

kubeadmin ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸå ´åˆã¯ã€ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã§ãã¾ã™ã€‚

```sh
$ crc console --credentials
To login as a regular user, run 'oc login -u developer -p developer https://api.crc.testing:6443'.
To login as an admin, run 'oc login -u kubeadmin -p abcd1234e5-ABC321-DEF654-a1b2c3 https://api.crc.testing:6443'
```

## CRC ã®åœæ­¢ã€å‰Šé™¤

ã‹ãªã‚Šãƒ¡ãƒ¢ãƒªã‚’é£Ÿã†ã®ã§ä½¿ç”¨ã—ãªã„å ´åˆã¯åŸºæœ¬è½ã¨ã—ã¦ãŠã„ãŸã»ã†ãŒè‰¯ã„ã§ã™ã€‚

```sh
# ã‚¯ãƒ©ã‚¹ã‚¿ã®åœæ­¢
$ crc stop
INFO Stopping kubelet and all containers..
INFO Stopping the OpenShift cluster, this may take a few minutes..
Stopped the OpenShift cluster

# ã‚¯ãƒ©ã‚¹ã‚¿ã®å‰Šé™¤
$ crc delete
o you want to delete the OpenShift cluster? [y/N]: y
Deleted the OpenShift cluster
```

## CRC ã‚³ãƒãƒ³ãƒ‰ã®è£œå®Œ

CRC ã«ã¯ã€ã‚·ã‚§ãƒ«ã®ä¿ç®¡æ©Ÿèƒ½ã‚‚ã‚ã‚Šã¾ã™ã€‚`crc completion` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ãŠä½¿ã„ã®ã‚·ã‚§ãƒ«ã«åˆã£ãŸè¨­å®šãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ macOS, zsh ã®å ´åˆã§ã™ã€‚ç•°ãªã‚‹ç’°å¢ƒã®å ´åˆã¯ã€`crc completion -h` ã§ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚

```sh
$ crc completion zsh > /usr/local/share/zsh/site-functions/_crc

# ã‚·ã‚§ãƒ«ã‚’å†èª­ã¿è¾¼ã¿
$ exec $SHELL -l

$ crc # ã“ã“ã§ã‚¿ãƒ–ã‚­ãƒ¼ã‚’æŠ¼ä¸‹
bundle      -- Manage CRC bundles
cleanup     -- Undo config changes
completion  -- generate the autocompletion script for the specified shell
config      -- Modify crc configuration
console     -- Open the OpenShift Web Console in the default browser
delete      -- Delete the OpenShift cluster
help        -- Help about any command
ip          -- Get IP address of the running OpenShift cluster
oc-env      -- Add the 'oc' executable to PATH
podman-env  -- Setup podman environment
setup       -- Set up prerequisites for the OpenShift cluster
start       -- Start the OpenShift cluster
status      -- Display status of the OpenShift cluster
stop        -- Stop the OpenShift cluster
version     -- Print version information
```

# ã¾ã¨ã‚

ä»Šå›ã¯ã€OpenShift ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½¿ç”¨ã§ãã‚‹ãƒ„ãƒ¼ãƒ« Red Hat CodeReady Containers ã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚Red Hat è£½å“ã‚’è³¼å…¥ã™ã‚‹å‰ã«è‡ªèº«ã®ãƒã‚·ãƒ³ã§æ°—è»½ã«è©¦ã™ã“ã¨ãŒã§ãã¾ã™ã€‚èˆˆå‘³ã®ã‚ã‚‹æ–¹ã¯æ¤œè¨¼ãªã©ã®éš›ã«æ˜¯éæ´»ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

# å‚è€ƒã«ã•ã›ã¦ã„ãŸã ã„ãŸã‚µã‚¤ãƒˆ

https://qiita.com/MahoTakara/items/83ea38e32987457ebbf4
https://korattablog.com/2020/05/18/mac-os-code-ready-container-crc-install/
https://nishipy.com/archives/1392
https://rheb.hatenablog.com/entry/2021/03/30/crc_tips
