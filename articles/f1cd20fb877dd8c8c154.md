---
title: "Nuxt.js sitemap"
emoji: "ğŸ‰"
type: "tech"
topics: ["nuxtjs", "vue", "seo"]
published: false
---
# ã¯ã˜ã‚ã«

Nuxt.js ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å‹•çš„ã«ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’ç”Ÿæˆã™ã‚‹ã¨æ©Ÿä¼šãŒã‚ã£ãŸã®ã§ã€ä¸€é€šã‚Šè©¦ã—ã¦ã¾ã¨ã‚ã¿ã¾ã—ãŸã€‚é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ“ãƒ«ãƒ‰ï¼ˆ`nuxt generate` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œï¼‰ã™ã‚‹ã¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« `sitemap.xml` ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ä»Šå›ã¯ä¸‹è¨˜ã®å…¬å¼ãŒæä¾›ã—ã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã„ã¾ã—ãŸã€‚

https://sitemap.nuxtjs.org/

åŸºæœ¬çš„ã«ã¯ã€ã“ã¡ã‚‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã€ç´°ã‹ã„è¨­å®šã‚’ nuxt.config.js ã«å®šç¾©ã—ã¦ã„ãã¨ã„ã£ãŸæµã‚Œã§ã™ã€‚ä¸‹è¨˜ãŒé››å½¢ã§ã™ã€‚

```sh
$ yarn add @nuxtjs/sitemap
```

```diff js:nuxt.config.js
export default {
  modules: [
    '@nuxtjs/axios',
+   '@nuxtjs/sitemap'
  ]
}
```

:::message
è¤‡æ•°ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ä¸Šè¨˜ã®ã‚ˆã†ã«ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æœ€å¾Œã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
:::

ã‚ã¨ã¯ä»»æ„ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã„å ´åˆã¯è¨­å®šã‚’è¿½åŠ ã—ã¦ã„ãã ã‘ã§ã™ã€‚


```diff js:nuxt.config.js
export default {
  modules: [
    '@nuxtjs/axios',
    '@nuxtjs/sitemap'
  ],
+  sitemap: {
+    // options: ã“ã“ã«è¿½è¨˜ã—ã¦ã„ã
+  }
}
```

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³

ãã‚Œã§ã¯ç¶šã„ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã„é …ç›®ã«ã¤ã„ã¦ä½¿ã£ãŸã‚‚ã®ã ã‘ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ç´¹ä»‹ã—ã¾ã™ã€‚

## hostname

ã‚µã‚¤ãƒˆã® URL ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚SPA, SSG ã§ã¯æŒ‡å®šãŒå¿…é ˆã¨ãªã£ã¦ã„ã‚‹ã®ã§å¿˜ã‚Œãšã«å®šç¾©ã—ã¾ã—ã‚‡ã†ã€‚

```diff js:nuxt.config.js
export default {
  sitemap: {
+   hostname: 'https://example.com'
  }
}
```

[dotenv](https://github.com/nuxt-community/dotenv-module) ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã©ã‚’åˆ©ç”¨ã—ã¦ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å€¤ã‚’å–å¾—ã§ãã‚‹çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚Œã°ã€ãƒ™ã‚¿æ›¸ãã™ã‚‹ã‚ˆã‚Šã‚‚ `process.env.BASE_URL` ã¨ã—ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚

## path

ç¶šã„ã¦ã¯ã€ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’åãå‡ºã™ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨ `./sitemap.xml` ã«ãªã£ã¦ã„ã‚‹ã®ã§ãã®ã¾ã¾ã§ã„ã„å ´åˆã¯ç‰¹ã«è¨­å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```diff js:nuxt.config.js
export default {
  sitemap: {
    hostname: 'https://example.com'
+   path: 'custom-sitemap.xml'
  }
}
```

## defaults

ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã®è¨­å®šå€¤ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨ãªã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å®šç¾©ã—ã¾ã™ã€‚è¤‡æ•°ã®ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’ç”Ÿæˆã—ãŸã„å ´åˆãªã©ã¯ã“ã“ã«ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚

è¨­å®šã§ãã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¤ã„ã¦è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¯ã€ä¸‹è¨˜ã«è©³ç´°ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã®ã§ãã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ã€‚

https://github.com/ekalinin/sitemap.js/blob/4.1.1/README.md#sitemap-item-options

ä»Šå›ã¯ã€ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚ï¼ˆ`lastmod`ï¼‰ã‚„æ›´æ–°é »åº¦ï¼ˆ`changefreq`ï¼‰ã‚’è¨­å®šã—ã¦ã¿ã¾ã—ãŸã€‚

```diff js:nuxt.config.js
export default {
  sitemap: {
    hostname: 'https://example.com'
    path: 'custom-sitemap.xml',
+   defaults: {
+     lastmod: new Date(),
+     changefreq: 'daily'
+   }
  }
}
```

## exclude

ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‹ã‚‰é™¤å¤–ã—ãŸã„ãƒ‘ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚è‰¯ãã‚ã‚‹ã‚±ãƒ¼ã‚¹ã¨ã—ã¦ã¯ã€ç®¡ç†è€…ãƒšãƒ¼ã‚¸ãªã©ã®ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ãƒšãƒ¼ã‚¸ã«ã¤ã„ã¦ã¯é™¤å¤–ã—ãŸã„ã“ã¨ãŒå¤šã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚

```diff js:nuxt.config.js
export default {
  sitemap: {
    hostname: 'https://example.com'
    path: 'custom-sitemap.xml',
    defaults: {},
+   exclude: ['/admin/**', '/tmp']
  }
}
```

## routes

é…åˆ—ã€ã‚ã‚‹ã„ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§å®šç¾©ã—ã¾ã™ã€‚æ˜ç¤ºçš„ã«ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ãŸã„å ´åˆã¯ã€ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```diff js:nuxt.config.js
export default {
  sitemap: {
    hostname: 'https://example.com'
    path: 'custom-sitemap.xml',
+   routes: ['first', 'second', 'third']
  }
}
```

ã¾ãŸã€è¨˜äº‹è©³ç´°ï¼ˆ`/articles/:id`ï¼‰ãªã©ã®å‹•çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯ç”Ÿæˆã•ã‚Œãªã„ã®ã§ API ãªã©ã‚’ä½¿ã£ã¦å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®å ´åˆã‚‚ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå½¹ã«ç«‹ã¡ã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€`/v1/articles` ã¨ã„ã†ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§è¨˜äº‹ã®ä¸€è¦§ãŒå–å¾—ã§ãã‚‹ API ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸå ´åˆã®ä¾‹ã§ã™ã€‚

```diff js:nuxt.config.js
+ import axios from 'axios'

export default {
  sitemap: {
    hostname: 'https://example.com'
    path: 'custom-sitemap.xml',
+   routes: async() => {
+     const { data } = await axios.get('api.example.com/v1/articles')
+     return data.map((article) => articles.id)
+   }
}
```
# ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

## è¤‡æ•°ã®ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’ç”Ÿæˆã—ãŸã„å ´åˆ

`sitemaps` ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ã¦é…åˆ—ã§è¤‡æ•°ã®ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```diff js:nuxt.config.js
export default {
  sitemap: {
    hostname: 'https://example.com'
    path: 'custom-sitemap.xml',
    defaults: {
      lastmod: new Date(),
      changefreq: 'daily'
    }
+   sitemaps: [
+     {
+       path: 'first.xml,
+       routes: ['first']
+     },
+     {
+       path: 'second.xml,
+       routes: ['second']
+     }
+   ]
  }
}
```


## è¤‡æ•°ã® API ã‚’å©ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã„å ´åˆ

ä¸Šã§ API ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã¯ `routes` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã¨è‰¯ã„ã¨è¿°ã¹ã¾ã—ãŸãŒã€è¤‡æ•°ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å¯¾è±¡ã«ã—ãŸå ´åˆã‚‚åŒæ§˜ã§ã™ã€‚

ä¸‹è¨˜ã®ã‚ˆã†ã« `Promise.all` ã‚’ä½¿ã£ã¦å…¨ã¦ã® Promise ãŒè¿”ã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¨å®Ÿç¾ã§ãã¾ã™ã€‚

```diff js:nuxt.config.js
+ import axios from 'axios'

export default {
  sitemap: {
    hostname: 'https://example.com'
    path: 'custom-sitemap.xml',
+   routes() {
+     return Promise.all([])
+   }
}
```

## ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿”ã™ API ã«å¯¾ã—ã¦å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã„å ´åˆ


# ã¾ã¨ã‚

